<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="xyz.welab.iframe.model.StudentMapper">
  <resultMap id="BaseResultMap" type="xyz.welab.iframe.pojo.Student">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="student_id" jdbcType="INTEGER" property="studentId" />
    <result column="student_name" jdbcType="VARCHAR" property="studentName" />
    <result column="student_age" jdbcType="VARCHAR" property="studentAge" />
    <result column="student_sex" jdbcType="VARCHAR" property="studentSex" />
    <result column="student_adress" jdbcType="VARCHAR" property="studentAdress" />
    <result column="first_paid_date_time" jdbcType="TIMESTAMP" property="firstPaidDateTime" />
    <result column="first_course_date_time" jdbcType="TIMESTAMP" property="firstCourseDateTime" />
    <result column="first_level" jdbcType="VARCHAR" property="firstLevel" />
    <result column="last_course_date_time" jdbcType="TIMESTAMP" property="lastCourseDateTime" />
    <result column="last_level" jdbcType="VARCHAR" property="lastLevel" />
    <result column="life_cycle" jdbcType="VARCHAR" property="lifeCycle" />
  </resultMap>

  <resultMap id="MyLltResultMap" type="xyz.welab.iframe.pojo.MyLlt">
    <result column="nxd" jdbcType="VARCHAR" property="nxd" />
    <result column="shuLiang" jdbcType="INTEGER" property="shuLiang" />
  </resultMap>

  <resultMap id="MyZtResultMap" type="xyz.welab.iframe.pojo.MyZt">
    <result column="dengji" jdbcType="VARCHAR" property="dengji" />
    <result column="age" jdbcType="VARCHAR" property="age" />
    <result column="shuLiang" jdbcType="INTEGER" property="shuLiang" />
  </resultMap>

  <sql id="Base_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    student_id, student_name, student_age, student_sex, student_adress, first_paid_date_time, 
    first_course_date_time, first_level, last_course_date_time, last_level, life_cycle
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from student
    where student_id = #{studentId,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from student
    where student_id = #{studentId,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="xyz.welab.iframe.pojo.Student">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into student (student_id, student_name, student_age, 
      student_sex, student_adress, first_paid_date_time, 
      first_course_date_time, first_level, last_course_date_time, 
      last_level, life_cycle)
    values (#{studentId,jdbcType=INTEGER}, #{studentName,jdbcType=VARCHAR}, #{studentAge,jdbcType=VARCHAR}, 
      #{studentSex,jdbcType=VARCHAR}, #{studentAdress,jdbcType=VARCHAR}, #{firstPaidDateTime,jdbcType=TIMESTAMP}, 
      #{firstCourseDateTime,jdbcType=TIMESTAMP}, #{firstLevel,jdbcType=VARCHAR}, #{lastCourseDateTime,jdbcType=TIMESTAMP}, 
      #{lastLevel,jdbcType=VARCHAR}, #{lifeCycle,jdbcType=VARCHAR})
  </insert>
  <insert id="insertSelective" parameterType="xyz.welab.iframe.pojo.Student">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into student
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="studentId != null">
        student_id,
      </if>
      <if test="studentName != null">
        student_name,
      </if>
      <if test="studentAge != null">
        student_age,
      </if>
      <if test="studentSex != null">
        student_sex,
      </if>
      <if test="studentAdress != null">
        student_adress,
      </if>
      <if test="firstPaidDateTime != null">
        first_paid_date_time,
      </if>
      <if test="firstCourseDateTime != null">
        first_course_date_time,
      </if>
      <if test="firstLevel != null">
        first_level,
      </if>
      <if test="lastCourseDateTime != null">
        last_course_date_time,
      </if>
      <if test="lastLevel != null">
        last_level,
      </if>
      <if test="lifeCycle != null">
        life_cycle,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="studentId != null">
        #{studentId,jdbcType=INTEGER},
      </if>
      <if test="studentName != null">
        #{studentName,jdbcType=VARCHAR},
      </if>
      <if test="studentAge != null">
        #{studentAge,jdbcType=VARCHAR},
      </if>
      <if test="studentSex != null">
        #{studentSex,jdbcType=VARCHAR},
      </if>
      <if test="studentAdress != null">
        #{studentAdress,jdbcType=VARCHAR},
      </if>
      <if test="firstPaidDateTime != null">
        #{firstPaidDateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="firstCourseDateTime != null">
        #{firstCourseDateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="firstLevel != null">
        #{firstLevel,jdbcType=VARCHAR},
      </if>
      <if test="lastCourseDateTime != null">
        #{lastCourseDateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="lastLevel != null">
        #{lastLevel,jdbcType=VARCHAR},
      </if>
      <if test="lifeCycle != null">
        #{lifeCycle,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="xyz.welab.iframe.pojo.Student">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update student
    <set>
      <if test="studentName != null">
        student_name = #{studentName,jdbcType=VARCHAR},
      </if>
      <if test="studentAge != null">
        student_age = #{studentAge,jdbcType=VARCHAR},
      </if>
      <if test="studentSex != null">
        student_sex = #{studentSex,jdbcType=VARCHAR},
      </if>
      <if test="studentAdress != null">
        student_adress = #{studentAdress,jdbcType=VARCHAR},
      </if>
      <if test="firstPaidDateTime != null">
        first_paid_date_time = #{firstPaidDateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="firstCourseDateTime != null">
        first_course_date_time = #{firstCourseDateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="firstLevel != null">
        first_level = #{firstLevel,jdbcType=VARCHAR},
      </if>
      <if test="lastCourseDateTime != null">
        last_course_date_time = #{lastCourseDateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="lastLevel != null">
        last_level = #{lastLevel,jdbcType=VARCHAR},
      </if>
      <if test="lifeCycle != null">
        life_cycle = #{lifeCycle,jdbcType=VARCHAR},
      </if>
    </set>
    where student_id = #{studentId,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="xyz.welab.iframe.pojo.Student">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update student
    set student_name = #{studentName,jdbcType=VARCHAR},
      student_age = #{studentAge,jdbcType=VARCHAR},
      student_sex = #{studentSex,jdbcType=VARCHAR},
      student_adress = #{studentAdress,jdbcType=VARCHAR},
      first_paid_date_time = #{firstPaidDateTime,jdbcType=TIMESTAMP},
      first_course_date_time = #{firstCourseDateTime,jdbcType=TIMESTAMP},
      first_level = #{firstLevel,jdbcType=VARCHAR},
      last_course_date_time = #{lastCourseDateTime,jdbcType=TIMESTAMP},
      last_level = #{lastLevel,jdbcType=VARCHAR},
      life_cycle = #{lifeCycle,jdbcType=VARCHAR}
    where student_id = #{studentId,jdbcType=INTEGER}
  </update>

  <select id="nianling" resultMap="MyLltResultMap">
    select student_age nxd,count(student_age) shuLiang from student where first_paid_date_time between #{start_date,jdbcType=TIMESTAMP} and #{end_date,jdbcType=TIMESTAMP} group by student_age;
  </select>

  <select id="diqu" resultMap="MyLltResultMap">
    select student_adress nxd,count(student_adress) shuLiang from student where first_paid_date_time between #{start_date,jdbcType=TIMESTAMP} and #{end_date,jdbcType=TIMESTAMP} group by  student_adress  order by count(*) desc;
  </select>

  <select id="xingbie" resultMap="MyLltResultMap">
    select student_sex nxd,count(student_sex) shuLiang from student where first_paid_date_time between #{start_date,jdbcType=TIMESTAMP} and #{end_date,jdbcType=TIMESTAMP} group  by student_sex  order by count(*) desc;
  </select>

  <select id="nianlingdengji" resultMap="MyZtResultMap">
    select last_level dengji,student_age age,count(*) shuLiang from student where first_paid_date_time between #{start_date,jdbcType=TIMESTAMP} and #{end_date,jdbcType=TIMESTAMP} group by last_level order by count(*) desc;
  </select>
  <select id="shangkeshijian" resultMap="MyZtResultMap">
    select hour(student_date) nxd,count(*) shuLiang from student_event  where student_date between #{start_date,jdbcType=TIMESTAMP} and #{end_date,jdbcType=TIMESTAMP} group by hour(student_date)
  </select>


</mapper>